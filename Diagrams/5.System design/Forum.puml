@startuml Forum
title Data Flow in the Forum

actor "Registered\nUser" as User
participant "Browser" as Browser
participant "Web Application\n(.NET MVC)" as WebApp
participant "Database\n(SQL Server)" as DB

User -> Browser : Opens forum page
Browser -> WebApp : HTTP GET /Forum
activate WebApp
WebApp -> DB : Retrieve categories and posts
activate DB
DB --> WebApp : Returns data
deactivate DB
WebApp --> Browser : Displays the page
deactivate WebApp

alt Creating a new post
    User -> Browser : Clicks "Create Post"
    Browser -> WebApp : HTTP POST /Forum/CreatePost (with data)
    activate WebApp
    WebApp -> DB : Save new post
    activate DB
    DB --> WebApp : Successful save
    deactivate DB
    WebApp --> Browser : Redirects to the forum page
    deactivate WebApp
else Creating a comment
    User -> Browser : Selects a post
    Browser -> WebApp : HTTP GET /Forum/PostDetails/{id}
    activate WebApp
    WebApp -> DB : Retrieve post and comments
    activate DB
    DB --> WebApp : Returns data
    deactivate DB
    WebApp --> Browser : Displays post details
    deactivate WebApp

    User -> Browser : Clicks "Comment" (on a post or another comment)
    Browser -> WebApp : HTTP POST /Forum/AddComment (with data)
    activate WebApp
    note right
    If it's a reply to another comment,
    it will also have a ParentId.
    end note
    WebApp -> DB : Save comment
    activate DB
    DB --> WebApp : Successful save
    deactivate DB
    WebApp --> Browser : Redirects to the post page
    deactivate WebApp
end
@enduml