<div class="container mt-4">
    <h4>Available Staff</h4>
    <div id="availableUsers">
        <div class="user" data-username="Admin1">Admin1</div>
        <div class="user" data-username="SellerJoe">SellerJoe</div>
        <div class="user" data-username="AdminLisa">AdminLisa</div>
    </div>
</div>

<div class="chat-popup" id="chatPopup">
    <div class="chat-header" id="chatWith"></div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input">
        <input type="text" id="messageInput" placeholder="Type a message..." />
        <button id="sendBtn" class="btn btn-primary btn-sm">Send</button>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        let currentChatUser = null;

        $(".user").on("dblclick", function () {
            const username = $(this).data("username");
            currentChatUser = username;

            $("#chatWith").text(`Chat with ${username}`);
            $("#chatMessages").empty();
            $("#chatPopup").fadeIn();
        });

        $("#sendBtn").on("click", function () {
            const message = $("#messageInput").val().trim();
            if (message === "") return;

            const messageBox = $("#chatMessages");
            messageBox.append(`<div class="message you"><strong>You:</strong> ${message}</div>`);
            messageBox.scrollTop(messageBox[0].scrollHeight);

            $("#messageInput").val('');

            setTimeout(() => {
                messageBox.append(`<div class="message other"><strong>${currentChatUser}:</strong> Got your message!</div>`);
                messageBox.scrollTop(messageBox[0].scrollHeight);
            }, 800);
        });
    </script>
}
